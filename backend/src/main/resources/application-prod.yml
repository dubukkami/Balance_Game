# ===============================
# ğŸ» ìˆ í•˜ì¬ë°¸ - ìš´ì˜ í™˜ê²½ (Railway + Neon DB)
# ===============================

# PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • (Neon DB)
DATABASE_URL: ${DATABASE_URL}  # Railwayì—ì„œ ìë™ ì„¤ì •
DB_DRIVER: org.postgresql.Driver
DB_USERNAME: ${DB_USERNAME}
DB_PASSWORD: ${DB_PASSWORD}

# H2 ì½˜ì†” ë¹„í™œì„±í™” (ë³´ì•ˆ)
H2_CONSOLE_ENABLED: false

# JPA ì„¤ì • (ìš´ì˜ìš©)
DDL_AUTO: update  # ìš´ì˜ì—ì„œëŠ” ìŠ¤í‚¤ë§ˆ ë³´ì¡´
SHOW_SQL: false   # ì„±ëŠ¥ìƒ SQL ë¡œê¹… ë¹„í™œì„±í™”
FORMAT_SQL: false
HIBERNATE_DIALECT: org.hibernate.dialect.PostgreSQLDialect
DATABASE_TYPE: postgresql

# CORS ì„¤ì • (ìš´ì˜ ë„ë©”ì¸)
CORS_ORIGINS: ${FRONTEND_URL}  # Vercel ë°°í¬ URL

# OAuth2 ë¦¬ë‹¤ì´ë ‰íŠ¸ URI (ìš´ì˜)
GOOGLE_REDIRECT_URI: ${BACKEND_URL}/login/oauth2/code/google
KAKAO_REDIRECT_URI: ${BACKEND_URL}/login/oauth2/code/kakao
NAVER_REDIRECT_URI: ${BACKEND_URL}/login/oauth2/code/naver
AUTHORIZED_REDIRECT_URI: ${AUTHORIZED_REDIRECT_URI}  # í”„ë¡ íŠ¸ì—”ë“œ ë¦¬ë‹¤ì´ë ‰íŠ¸ URL

# ì„œë²„ ì„¤ì • (Railway ìë™ í¬íŠ¸)
SERVER_PORT: ${PORT:8080}

# JWT ì„¤ì • (ìš´ì˜ìš© - ê¸´ ë§Œë£Œì‹œê°„)
JWT_SECRET: ${JWT_SECRET}  # ê°•ë ¥í•œ ì‹œí¬ë¦¿ í‚¤ í•„ìˆ˜
JWT_TOKEN_VALIDITY: ${JWT_TOKEN_VALIDITY:604800}  # 7ì¼

# ë¡œê¹… ì„¤ì • (ìš´ì˜ìš© - ìµœì†Œ ë¡œê¹…)
LOG_LEVEL_ROOT: WARN
LOG_LEVEL_APP: INFO
LOG_LEVEL_WEB: WARN
LOG_LEVEL_SQL: WARN
LOG_LEVEL_SQL_PARAMS: WARN

# ìš´ì˜ í™˜ê²½ ì „ìš© ì„¤ì •
spring:
  # ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥ì…˜ í’€ ìµœì í™” (ë¬´ë£Œ í”Œëœ ê³ ë ¤)
  datasource:
    hikari:
      maximum-pool-size: ${DB_MAX_POOL_SIZE:5}
      minimum-idle: ${DB_MIN_IDLE:1}
      idle-timeout: ${DB_IDLE_TIMEOUT:300000}      # 5ë¶„
      max-lifetime: ${DB_MAX_LIFETIME:1200000}     # 20ë¶„
      connection-timeout: ${DB_CONNECTION_TIMEOUT:20000}  # 20ì´ˆ
      leak-detection-threshold: ${DB_LEAK_DETECTION:60000}  # 1ë¶„

  # ì—ëŸ¬ ì²˜ë¦¬ (ìš´ì˜ìš©)
  web:
    resources:
      add-mappings: false  # ì •ì  ë¦¬ì†ŒìŠ¤ ë¹„í™œì„±í™”
  
  # Jackson ì§ë ¬í™” ìµœì í™”
  jackson:
    default-property-inclusion: NON_NULL
    serialization:
      write-dates-as-timestamps: false

# ì„œë²„ ìµœì í™” ì„¤ì • (Railway ë¬´ë£Œ í”Œëœ ëŒ€ì‘)
server:
  # Tomcat ì»¤ë„¥ì…˜ ìµœì í™”
  tomcat:
    max-connections: ${SERVER_MAX_CONNECTIONS:50}
    accept-count: ${SERVER_ACCEPT_COUNT:10}
    max-threads: ${SERVER_MAX_THREADS:20}
    min-spare-threads: ${SERVER_MIN_THREADS:2}
    connection-timeout: ${SERVER_CONNECTION_TIMEOUT:20000}
    
  # ì‘ë‹µ ì••ì¶• (íŠ¸ë˜í”½ ì ˆì•½)
  compression:
    enabled: true
    mime-types: text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,application/xml
    min-response-size: 1024
    
  # ì—ëŸ¬ í˜ì´ì§€ ë¹„í™œì„±í™” (ë³´ì•ˆ)
  error:
    whitelabel:
      enabled: false
    include-stacktrace: never
    include-message: never

# í—¬ìŠ¤ì²´í¬ ë° ëª¨ë‹ˆí„°ë§ (Railway ëŒ€ì‘)
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
      base-path: /actuator
  endpoint:
    health:
      show-details: when-authorized
      cache:
        time-to-live: ${HEALTH_CACHE_TTL:5s}
    info:
      enabled: true
  health:
    diskspace:
      threshold: ${HEALTH_DISK_THRESHOLD:100MB}
    db:
      enabled: true

# ì•± ë©”íƒ€ë°ì´í„°
app:
  name: ìˆ í•˜ì¬ë°¸
  version: ${APP_VERSION:1.0.0}
  environment: production
  
# ë³´ì•ˆ ì„¤ì •
security:
  require-ssl: ${REQUIRE_SSL:false}  # RailwayëŠ” ìë™ HTTPS ì œê³µ