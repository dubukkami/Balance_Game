# ===============================
# ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • (ìš´ì˜í™˜ê²½)
# ===============================
spring:
  datasource:
    # Neon DB ë¬´ë£Œ PostgreSQL ì„œë²„ ì—°ê²°
    # í˜•ì‹: postgresql://username:password@hostname/database?sslmode=require
    url: ${DATABASE_URL:jdbc:postgresql://ep-example-123456.us-east-1.aws.neon.tech/balancegame?sslmode=require}
    username: ${DB_USERNAME:your_neon_username}
    password: ${DB_PASSWORD:your_neon_password}
    driver-class-name: org.postgresql.Driver
    
    # ì»¤ë„¥ì…˜ í’€ ìµœì í™” (ë¬´ë£Œ í”Œëœ ê³ ë ¤)
    hikari:
      maximum-pool-size: 5       # ìµœëŒ€ ì—°ê²° ìˆ˜ (ë¬´ë£Œ í”Œëœ ì œí•œ ê³ ë ¤)
      minimum-idle: 1            # ìµœì†Œ ìœ íœ´ ì—°ê²°
      idle-timeout: 300000       # 5ë¶„ ìœ íœ´ íƒ€ì„ì•„ì›ƒ
      max-lifetime: 1200000      # 20ë¶„ ìµœëŒ€ ìƒëª…ì£¼ê¸°
      connection-timeout: 20000   # 20ì´ˆ ì—°ê²° íƒ€ì„ì•„ì›ƒ
  
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: false
    database: postgresql
  
  web:
    cors:
      allowed-origins: ${FRONTEND_URL:https://yourusername.github.io}
      allowed-methods: GET, POST, PUT, DELETE, OPTIONS
      allowed-headers: "*"
      allow-credentials: true
  
  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            redirect-uri: "${BACKEND_URL:https://your-backend.railway.app}/login/oauth2/code/google"
            scope:
              - email
              - profile
          kakao:
            client-id: ${KAKAO_CLIENT_ID}
            client-secret: ${KAKAO_CLIENT_SECRET}
            redirect-uri: "${BACKEND_URL:https://your-backend.railway.app}/login/oauth2/code/kakao"
            authorization-grant-type: authorization_code
            scope:
              - profile_nickname
              - account_email
              - profile_image
            client-name: Kakao
          naver:
            client-id: ${NAVER_CLIENT_ID}
            client-secret: ${NAVER_CLIENT_SECRET}
            redirect-uri: "${BACKEND_URL:https://your-backend.railway.app}/login/oauth2/code/naver"
            authorization-grant-type: authorization_code
            scope:
              - name
              - email
              - profile_image
            client-name: Naver
        provider:
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
            user-name-attribute: response

server:
  port: ${PORT:8080}

# JWT ì„¤ì •
jwt:
  secret: ${JWT_SECRET}
  token-validity-in-seconds: ${JWT_TOKEN_VALIDITY:86400}

# ì•± ì„¤ì •
app:
  oauth2:
    authorized-redirect-uri: ${AUTHORIZED_REDIRECT_URI}

logging:
  level:
    org.springframework.web: INFO
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql.BasicBinder: WARN

# ===============================
# ğŸ¥ í—¬ìŠ¤ì²´í¬ ë° ëª¨ë‹ˆí„°ë§ ì„¤ì •
# ===============================
management:
  endpoints:
    web:
      exposure:
        # ìš´ì˜í™˜ê²½ì—ì„œ í•„ìš”í•œ ì—”ë“œí¬ì¸íŠ¸ë§Œ ë…¸ì¶œ (ë³´ì•ˆ ê°•í™”)
        include: health,info,metrics
      base-path: /actuator
  endpoint:
    health:
      # í—¬ìŠ¤ì²´í¬ ìƒì„¸ ì •ë³´ í‘œì‹œ (ì¸ì¦ëœ ì‚¬ìš©ìë§Œ)
      show-details: when-authorized
      # í—¬ìŠ¤ì²´í¬ ì‘ë‹µ ìºì‹œ (5ì´ˆ) - Railway ë¬´ë£Œ í”Œëœ ìµœì í™”
      cache:
        time-to-live: 5s
    info:
      # ì• í”Œë¦¬ì¼€ì´ì…˜ ì •ë³´ í™œì„±í™”
      enabled: true
  
  # ===============================
  # â° ìë™ ì¢…ë£Œ ìŠ¤ì¼€ì¤„ë§ (9ì‹œ-6ì‹œ ìš´ì˜)
  # ===============================
  # RailwayëŠ” ìë™ìœ¼ë¡œ ë¹„í™œì„± ì‹œê°„ í›„ ìŠ¬ë¦½ ëª¨ë“œ
  # í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨ ì‹œ ìë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
  health:
    # ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ì²´í¬ (Railway ì œí•œ ê³ ë ¤)
    diskspace:
      threshold: 100MB
    # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì²´í¬
    db:
      enabled: true
      
# ===============================
# ğŸ”§ ì„œë²„ ìµœì í™” ì„¤ì •
# ===============================
server:
  # Railway ìë™ í• ë‹¹ í¬íŠ¸ ì‚¬ìš©
  port: ${PORT:8080}
  
  # ì»¤ë„¥ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì • (ë¬´ë£Œ í”Œëœ ìµœì í™”)
  tomcat:
    max-connections: 50          # ìµœëŒ€ ë™ì‹œ ì—°ê²° ìˆ˜
    accept-count: 10             # ëŒ€ê¸°ì—´ í¬ê¸°
    max-threads: 20              # ìµœëŒ€ ìŠ¤ë ˆë“œ ìˆ˜
    min-spare-threads: 2         # ìµœì†Œ ìŠ¤ë ˆë“œ ìˆ˜
    connection-timeout: 20000    # 20ì´ˆ ì—°ê²° íƒ€ì„ì•„ì›ƒ
    
  # ì••ì¶• ì„¤ì • (íŠ¸ë˜í”½ ìµœì í™”)
  compression:
    enabled: true
    mime-types: text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
    min-response-size: 1024
    
  # ì—ëŸ¬ í˜ì´ì§€ ì„¤ì •
  error:
    whitelabel:
      enabled: false